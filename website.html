<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <link rel="icon" href="./images/logo.jpg">

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""/>

    <script src="https://d3js.org/d3.v5.min.js"></script>

    <script src="./js/leaflet.js"></script>

    <script src="./js/jquery-3.6.0.min.js"></script>
    <script src="./js/vegas.min.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/vegas/2.4.4/vegas.min.css" />
    <link href="css/tooplate-barista.css" rel="stylesheet">
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/bootstrap-icons.css" rel="stylesheet">
    <link href="css/vegas.min.css" rel="stylesheet">

    <link href="https://fonts.googleapis.com/css2?family=Oswald&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Lato&display=swap" rel="stylesheet">
    <script src="https://kit.fontawesome.com/a076d05399.js"></script>
    <script src='https://cdn.plot.ly/plotly-2.32.0.min.js'></script>
                <script src='https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js'></script>
</head>

<body>
<main>
    <section class="lang_bar">
        <input type="checkbox" id="active">
        <label for="active" class="menu-btn"><i >L</i></label>
        <div class="lang_wrapper">
            <h2 class="lang_exp" style="margin-top:50px;"><b>As The Travels by Marco Polo has been transcribed and translated into various manuscripts and early printed editions, there are several variations in the location names mentioned in the text. To ensure clarity, our website has referred to three sources for displaying the location names: </b></h2>
            <h2 class="lang_exp lang_exp_select" >
                <mark style="color:#01204d; background-color:#fff"><b>Cliff:</b></mark> From the translation of "The Travels" by Nigel Cliff, published by Penguin Classics in 2015.
                <br><mark style="color:#01204d; background-color:#fff"><b>Haw:</b></mark> From the book "Marco Polo's China: A Venetian in the Realm of Khubilai Khan" by Stephen G. Haw, first published in 2006 by Routledge.
                <br><mark style="color:#01204d; background-color:#fff"><b>中文:</b></mark> From modern China map.</h2>
            <h2 class="lang_exp" ><b>Please select the version you prefer.</b></h2>
            <ul>
                <li><a class="text-white" onclick="cliff_list()">CLIFF</a></li>
                <li><a class="text-white" onclick="h_list()">Haw</a></li>
                <li><a class="text-white" onclick="cn_list()">中文</a></li>
            </ul>
        </div>


        <script>

        function find_list(editionName){
            d3.csv("csv/name.csv", function(data) {
                // Access the data in the specified column
                
                window.columnValues = data.map(function(row) { return row[editionName]; });
                //callback(columnValues); // Call the callback function with the column values
            });
            
            
        }

        function cliff_list(){
            location.href = window.location.pathname + '?lang=Cliff';
            //location.reload();
        }

        function h_list(){
            location.href = window.location.pathname + '?lang=Haw';
        }

        function cn_list(){
            location.href = window.location.pathname + '?lang=cn';
        }

        
        var myValue = "Haw"

        try {
            const urlParams = new URLSearchParams(window.location.search);
            myValue = urlParams.get('lang').toString();
        } catch (error) {
        }
        find_list(myValue);
        

        </script>
    </section>


    <section id="page_1" class=" hero-section d-flex justify-content-center align-items-center" style="padding: 0;">
        <div class="container">
            <div class="align-items-center">
                <div class="text-white">
                    <h1 style="font-size:400%;"><b>A Study on <br><br><mark style="color:aliceblue; background-color: #61a0ff;line-height:2;">Marco Polo's View of China</mark></b></h1>
                </div>
            </div>
        </div>
        <div class="hero-slides" style="filter: brightness(60%); "></div>
        
        <script>
            $(function() {
              $('.hero-slides').vegas({
                  slides: [
                      { src: './images/banner7.jpg' },
                      { src: './images/banner6.jpg' },
                  ],
                  timer: false,
                  animation: 'kenburns',
              });
            });
        </script>
    </section>

    <section id="connect-bar" style="height:50px; background-color:#ffffff;">
    </section>

    <section class="barista-section section-padding section-bg1" style="height:800px" id="page_2">
        <div class="container" style="height:700px;margin-top:30px;margin-bottom:30px">
            <div style="width:100%;height:60%">
                <img src="./images/Marco_Polo.jpg" style="overflow: hidden;height:100%;float:left; max-width:800px; width:50%;" >
                <h5 class="intro_marco" style="margin-top:20px;height:45%; width:40%; float:right;color:#eaeaea"><mark class="text-white" style="background-color:#61a0ff; font-size:140%">Marco Polo(1254—1324)</mark>, was an Italian merchant and traveler.At the age of 17, he embarked on a journey to the Orient with his father and uncle. During his 17-year stay in China, he explored many regions, including southwest mountain area and the southeastern coastal area. Upon his return to Italy, Marco Polo was captured in a battle and imprisoned. While in prison, he recounted his experiences and adventures during his travels. With the assistance of his cellmate Rustichello, he documented his travels in the famous book ——<mark class="text-white" style="background-color:#333d4d">The Travels</mark>.</h5>
            </div>
            <div style="width:100%;height:40%;margin-top:30px">
                <h5 class="intro_marco" style="color:#9f9f9f" ><mark class="text-white" style="background-color:#61a0ff; font-size:140%">The Objective</mark> of this project is to utilize ancient cartographic maps of China, dating back to the time of Marco Polo, to showcase the locations he visited during his travels in China and the concerns he expressed about them in his narratives. Unlike the travelogues of Chinese literati of the same period, Marco Polo's preoccupations were unique. As a merchant, he was naturally interested in local industries and specialties, and meticulously recorded the prices of goods in his books. Additionally, as a devout religious believer, he was also concerned about the state of faith of the local people. Therefore, we decided to present the cities mentioned in Marco Polo's travels in three areas: religion, specialties and economic activities, which he frequently mentioned in his accounts. The website will provide an interactive and informative experience for users, enabling them to explore and comprehend the historical routes of Marco Polo's travels in China, while also gaining insight into the local customs he described.</h5>
            </div>
        </div>
        </section>
    </main>

    <section id="connect-bar" style="height:50px; background-color:#ffffff;">
    </section>

    <section class="barista-section section-padding section-bg2" style="height:750px" id="page_3">
        <!--<div style="background-color:#d9e6f3;height: 730px;width:100%">-->
        <div class="container">
            <!--<p class="text-white" style="text-align:center; font-size:300%;font-weight: 1000;">Map</p>-->
            <div style=" float:left; width:50%">
                <div id="map" style="height: 700px; max-width: 500px;z-index: 20;"></div>
                <p style="line-height:2;font-size:100%;"><em>《九域守令圖》</em></p>
            </div>
            <div class="align-items-center" style=" float:right; height:650px;width:50%; margin-top:10px;">
                <div class="rec-1" style="display:inline-block;margin-top:20px;">
                    <div class="map-select " style="color:#01204d">
                        <div class="my-word">
                            <span class="my-span" style="--i:0.5">W</span>
                            <span class="my-span" style="--i:0.75">h</span>
                            <span class="my-span" style="--i:1">a</span>
                            <span class="my-span"style="--i:1.25">t&nbsp;</span>
                        </div>
                        <div class="my-word">
                            <span class="my-span" style="--i:1.5">W</span>
                            <span  class="my-span"style="--i:1.75">o</span>
                            <span class="my-span"style="--i:2">u</span>
                            <span class="my-span"style="--i:2.25">l</span>
                            <span class="my-span" style="--i:2.5">d&nbsp;</span>
                        </div>
                        <div class="my-word">
                            <span class="my-span" style="--i:2.75">Y </span>
                            <span class="my-span" style="--i:3">o</span>
                            <span  class="my-span"style="--i:3.25">u&nbsp;</span>
                        </div>
                        <div class="my-word">
                            <span class="my-span"style="--i:3.5">L</span>
                            <span class="my-span"style="--i:3.75">i</span>
                            <span class="my-span" style="--i:4">k</span>
                            <span class="my-span" style="--i:4.25">e&nbsp;</span>
                        </div>
                        <div class="my-word">
                            <span class="my-span"style="--i:4.5">t</span>
                            <span class="my-span"style="--i:4.75">o&nbsp;</span>
                        </div>
                        <div class="my-word">
                            <span class="my-span"style="--i:5">L</span>
                            <span class="my-span"style="--i:5.25">e</span>
                            <span class="my-span" style="--i:5.5">a</span>
                            <span class="my-span" style="--i:5.75">r</span>
                            <span class="my-span" style="--i:6">n</span>
                            <span class="my-span" style="--i:6.25">?</span>
                        </div>
                        <p><br></p>
                        <div id="cover" style="position:relative; margin-top:20px">
                            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
                            <form id="search-form" method="get" action="">
                            <div class="wrap">
                                <div class="search">
                                   <input id="search-input" type="text" class="searchTerm" placeholder="Search by Location...">
                                   <button type="submit" class="search_button">
                                     <i class="fa fa-search"></i>
                                  </button>
                                </div>
                            </div>
                            </form>
                        </div>
                        <p style="color:#143176;margin-top:15px">-------------OR-------------</p>
                        <button class="button-map button02 rec-click rec2" role="button" data-react="rec-2" onclick="overview_map()">Overview</button>
                        <button class="button-map button01 rec-click rec3" role="button" data-react="rec-3"  onclick="button_start()">Religion</button>
                        <button class="button-map button01 rec-click rec4" role="button" data-react="rec-4" onclick="button_start()">Specialty</button>
                        <button class="button-map button01 rec-click rec5" role="button" data-react="rec-5" onclick="button_start()">Economic Activities</button>
                        
                    </div>
                </div>
                <div class="rec-2" style="height:100%;width:100%;display:none">
                    <div id="overview_viz"style="margin-left:20px;height:100%;width:100%">
                        <p id="map-text-2" class="select_text" style="color:#3e5e88; height:8%"><b>The Top 12 Mostly described Chinese Locations(words)</b></p>
                        <!-- Load d3.js -->
                        <script src="https://d3js.org/d3.v4.js"></script>
                        <!-- Create a div where the graph will take place -->
                        <div id="my_dataviz_1" class="dataviz-2"style="display:inline-block;text-align:center;height:72%;width:100%"></div>
                        <p style="text-align:center;height:11%;line-height:1.75">Number of Chinese Locations Marco-Polo have described: <mark>58</mark><br>Average Number of Words used to describe one location: <mark>419.6</mark></p>
                        <button  id="button-return-2" class="button-return" style="height:5%;margin-top:20px" onclick="return_rec_1()"><u>Return</u></button>
                    </div>
                </div>

                <div class="rec-3" style="height:100%;width:100%;display:none">
                    <div style="margin-left:20px;height:100%;width:100%">
                        <p id="map-text-3" class="select_text" style="color:#01204d;"><b>Religion</b></p>
                        <div id="my_dataviz_2" style="display:inline-block;text-align:center;height:72%;width:100%"></div>
                        <p style="text-align:center;height:11%;line-height:1.75">Over 70% of places were recorded to have Idolaters living</p>
                        <button id="button-return-3" class="button-return" onclick="return_rec_1()"><u>Return</u></button>
                    </div>
                </div>

                <div class="rec-4" style="height:100%;width:100%;display:none" >
                    <div style="margin-left:20px;height:100%;width:100%">
                        <p id="map-text-4" class="select_text" style="color:#01204d;"><b>Specialty</b></p>
                        <div id="my_dataviz_3" style="display:inline-block;text-align:center;height:72%;width:100%"></div>
                        <p class="extra_map_4" style="text-align:left;height:16%;line-height:1.75">
                            <mark>Crafted Items:</mark>Porcelain, Silk, Cotton cloth, Fabrics, Cloths made from bark, Sendal, Wine, Vessel...
                            <br><mark>Animal or Animal Products:</mark>Wild animals, Lion, Musk, Mastiffs, Black silky fowl, Fish...
                            <br><mark>Luxury goods:</mark> Gold, Pearls, Turquoise, Spices (ginger, galangal, cloves, saffron), Sugar, Musk...
                            <br><mark>Agricultural products:</mark> Wheat, Corn, Rice, Fruit, Peach, Jujube, Grain, Canes...</p>
                        <button id="button-return-4" class="button-return" onclick="return_rec_1()"><u>Return</u></button>
                    </div>
                </div>

                <div class="rec-5" style="height:100%;width:100%;display:none">
                    <div style="margin-left:20px;height:100%;width:100%">
                        <p id="map-text-5" class="select_text" style="color:#01204d;"><b>Economic Activities</b></p>
                        <div id="my_dataviz_4" style="display:inline-block;text-align:center;height:72%;width:100%"></div>
                        <p style="text-align:center;height:11%;line-height:1.75"><mark>Trade</mark> and <mark>Industry</mark> are the two main economic activities described by Marco Polo.</p>
                        <button id="button-return-5" class="button-return" onclick="return_rec_1()"><u>Return</u></button>
                    </div>
                </div>

                <script>
                const observer = new IntersectionObserver(entries => {
                    entries.forEach(entry => {
                        const mySpans = entry.target.querySelectorAll('span.my-span');
                        mySpans.forEach(span => {
                            if (entry.isIntersecting) {
                                span.classList.add('jump');
                            } else {
                                span.classList.remove('jump');
                            }
                        });
                    });
                });

                observer.observe(document.querySelector('.map-select'));

                $(function(){
                    $(".rec-click").click(function(){
                        var target = $(this).data("react");
                    $("."+target).show().siblings("div[class*=rec-]").hide();
                })
                }); 
    
                $(function() {
                // Get all the buttons with class "btn"
                var rectangles = $(".rec");
    
                // Iterate over each button
                rectangles.each(function(index) {
                    console.log(index)
                    // Get the corresponding section with class "section-{index+1}"
                    var section = $(".rec-" + (index+1));
  
                    // Add a click event listener to the button
                    $(this).click(function() {
                    // Hide all sections except the current one
                        $(".rec").not(section).hide();
        
                        // Show the current section
                        section.show();

                    });
                });
                });

                $(document).ready(function(){
                    for (let i = 2; i <= 5; i++) {
                        const map_button=document.querySelector(`.rec${i}`);
                        const text = document.querySelector(`#map-text-${i}`);
                        const button_return = document.querySelector(`#button-return-${i}`);
                        map_button.addEventListener("click",function(e) {
                            text.style.display = 'flex';
                            button_return.style.display = 'inline-block'
                        })
                    }
                })
                

                function return_rec_1(){
                    for (let i = 2; i <= 5; i++) {
                        $(".rec-" + i).hide()
                        $("#map-text-" + i).hide()
                        $("#button-return-" + i).hide()
                    
                    }
                    $(".rec-1").show();
                    return_map();
                }

                </script>
                <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>

                <script>
                    // Get the search form and input field
                    var searchForm = document.getElementById('search-form');
                    var searchInput = document.getElementById('search-input');
                  
                    // Listen for the form submission event
                    searchForm.addEventListener('submit', function(event) {
                        event.preventDefault(); // Prevent the form from submitting
                  
                      // Get the word that the user wants to search
                        var go_searchWord = searchInput.value;
                        
                        if (myValue=="Cliff" ){
                            go_searchWord=go_searchWord.charAt(0).toUpperCase() + go_searchWord.slice(1).toLowerCase()
                            if(go_searchWord==="Fuzhou"){
                                go_searchWord="Fuzhou-City";
                            }else if (go_searchWord==="Kuizhou"){
                                go_searchWord="Kuizhou-Province";
                            }else if (go_searchWord==="Chang'anfu"){
                                go_searchWord="Chang’anfu";
                            }
                        }
                        
                        

                        console.log('Search word: ' + go_searchWord);

                        current_markers.forEach(function(marker) {
                            if (go_searchWord===columnValues[marker.popupContent]){
                                map.setView([marker.lat,marker.lng],9)
                            }
                        })
                    
                  
                      // Do something with the search word, such as search a database or display search results
                      
                    });
                  </script>

                <script>
                    var path_name='csv/wordcount.csv'
                    if (myValue=="Cliff"){
                        path_name='csv/wordcount.csv'
                    }else if(myValue=="Haw"){
                        path_name='csv/wordcount_haw.csv'
                    }else if(myValue=="cn"){
                        path_name='csv/wordcount_cn.csv'
                    }
                    var plt_width=window.innerWidth*0.4;
                    function reportWindowSize() {
                        plt_width= window.innerWidth*0.4;
                        console.log(plt_width)
                    }
                    window.onresize = reportWindowSize;

                    svg_overview = d3.csv(path_name, function (err, rows) {
                        function unpack(rows, key) {
                            return rows.map(function (row) {
                                return row[key]
                            });
                        }

                        var data = [{
                            type: "treemap",
                            values: unpack(rows, 'Word'),
                            labels: unpack(rows, "Location"),
                            textinfo: "label+value",
                            parents: unpack(rows, ''),
                        }];
                        
                        var layout = {
                            treemapcolorway: ["royalblue", "lightblue"],
                            margin: {
                                l: 0,  // Set the left margin to 50 pixels
                                r: 5,  // Set the right margin to 50 pixels
                                b: 0,  // Set the bottom margin to 50 pixels
                                t: 0   // Set the top margin to 50 pixels
                            },
                            // Set the padding of the plot area to 0 pixels
                            //xaxis: {zeroline:false, showline:false},
                            //yaxis: {zeroline:false, showline:false},
                            autosize: true,
                            width: plt_width
                            //height:window.innerHieght*0.2

                        }
                        var config = {
                            responsive: true,
                            
                        }
                        Plotly.newPlot('my_dataviz_1', data, layout, config);
                    })
                </script>

                <script>
                    d3.csv('csv/Religion.csv', function (err, rows) {
                        function unpack(rows, key) {
                            return rows.map(function (row) {
                                return row[key]
                            });
                        }

                        var data = [{
                            type: "treemap",
                            values: unpack(rows, 'Percent'),
                            labels: unpack(rows, 'Religion'),
                            textinfo: "label+value",
                            parents: unpack(rows, ''),
                        }];
                        var layout = {
                            treemapcolorway: ["royalblue", "lightblue"],
                            margin: {
                                l: 0,  // Set the left margin to 50 pixels
                                r: 0,  // Set the right margin to 50 pixels
                                b: 0,  // Set the bottom margin to 50 pixels
                                t: 0   // Set the top margin to 50 pixels
                            },
                            autosize: true,
                            width: window.innerWidth*0.4,
                        }
                        var config = {
                            responsive: true
                        }
                        Plotly.newPlot('my_dataviz_2', data, layout, config);

                        
                        var getback = 0;
                        document.getElementById('my_dataviz_2').on('plotly_click', function(data) {
                            var point = data.points[0];
                            console.log(getback)
                            religion_map(point.label,getback)
                            if (getback===0){
                                getback++;
                            }else{
                                getback=0
                            }
                        });
                        
                    })
                </script>

                <script>
                    d3.csv('csv/specialty.csv', function (err, rows) {
                        function unpack(rows, key) {
                            return rows.map(function (row) {
                                return row[key]
                            });
                        }

                        var data = [{
                            type: "treemap",
                            values: unpack(rows, 'Number'),
                            labels: unpack(rows, 'Specialty'),
                            textinfo: "label+value",
                            parents: unpack(rows, ''),
                        }];
                        var layout = {
                            treemapcolorway: ["royalblue", "lightblue"],
                            margin: {
                                l: 0,  // Set the left margin to 50 pixels
                                r: 0,  // Set the right margin to 50 pixels
                                b: 0,  // Set the bottom margin to 50 pixels
                                t: 0   // Set the top margin to 50 pixels
                            },
                            autosize: true,
                            width: window.innerWidth*0.4,
                            //height: window.innerHeight*0.6
                        }
                        var config = {
                            responsive: true
                        }
                        Plotly.newPlot('my_dataviz_3', data, layout, config);

                        var getback = 0;
                        document.getElementById('my_dataviz_3').on('plotly_click', function(data) {
                            var point = data.points[0];
                            console.log(getback)
                            specialty_map(point.label,getback)
                            if (getback===0){
                                getback++;
                            }else{
                                getback=0
                            }
                        });
                        
                    })
                </script>
                <script>
                    d3.csv('csv/economics.csv', function (err, rows) {
                        function unpack(rows, key) {
                            return rows.map(function (row) {
                                return row[key]
                            });
                        }

                        var data = [{
                            type: "treemap",
                            values: unpack(rows, 'Percent'),
                            labels: unpack(rows, 'economics'),
                            textinfo: "label+value",
                            parents: unpack(rows, ''),
                        }];
                        var layout = {
                            treemapcolorway: ["royalblue", "lightblue"],
                            margin: {
                                l: 0,  // Set the left margin to 50 pixels
                                r: 0,  // Set the right margin to 50 pixels
                                b: 0,  // Set the bottom margin to 50 pixels
                                t: 0   // Set the top margin to 50 pixels
                            },
                            autosize: true,
                            width: window.innerWidth*0.4,
                        }
                        var config = {
                            responsive: true
                        }
                        Plotly.newPlot('my_dataviz_4', data, layout, config);

                        var getback = 0;
                        document.getElementById('my_dataviz_4').on('plotly_click', function(data) {
                            var point = data.points[0];
                            console.log(getback)
                            economics_map(point.label,getback)
                            if (getback===0){
                                getback++;
                            }else{
                                getback=0
                            }
                        });
                        
                    })
                </script>

            </div>
        </div>
        </div>
            <script>
                var map = L.map('map',{
                maxBounds:[[17, 100], [42, 123]],
                maxBoundsViscosity: 1,
                minZoom:5,
                }).setView([30.0, 112], 5);
                L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
                maxZoom: 10,
                minZoom: 3,
                attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
                }).addTo(map);

                /*map.on('click', function(e) {
                    alert("Lat, Lon : " + e.latlng.lat + ", " + e.latlng.lng)
                });*/


                //add historical map
                var imageUrl = "./images/map07.png",
                //imageBounds = [[10, 80], [60, 130]];
                imageBounds = [[17, 100], [42, 123]];
                L.imageOverlay(imageUrl, imageBounds,{opacity:1}).addTo(map);

                //logo template
                var anyIcon = L.Icon.extend({
                    options: {
                        shadowUrl: './images/shadow2.png',
                        iconSize:     [35, 35], // size of the icon
                        shadowSize:   [40, 40]
                    }
                });

                //import logos of different colors
                var greenIcon = new anyIcon({iconUrl: './images/green.png'}),
                    greenIcon01 = new anyIcon({iconUrl: './images/green01.png'}),
                    greenIcon02 = new anyIcon({iconUrl: './images/green02.png'}),
                    greenIcon03 = new anyIcon({iconUrl: './images/green03.png'}),
                    greenIcon04 = new anyIcon({iconUrl: './images/green04.png'}),
                    redIcon = new anyIcon({iconUrl: './images/red.png'}),
                    redIcon01 = new anyIcon({iconUrl: './images/red01.png'}),
                    redIcon02 = new anyIcon({iconUrl: './images/red02.png'}),
                    redIcon03 = new anyIcon({iconUrl: './images/red03.png'}),
                    redIcon04 = new anyIcon({iconUrl: './images/red04.png'}),
                    redIcon05 = new anyIcon({iconUrl: './images/red05.png'}),
                    redIcon06 = new anyIcon({iconUrl: './images/red06.png'}),
                    redIcon07 = new anyIcon({iconUrl: './images/red07.png'}),
                    redIcon08 = new anyIcon({iconUrl: './images/red08.png'}),
                    redIcon09 = new anyIcon({iconUrl: './images/red09.png'}),
                    redIcon10 = new anyIcon({iconUrl: './images/red10.png'}),
                    redIcon11 = new anyIcon({iconUrl: './images/red11.png'}),
                    redIcon12 = new anyIcon({iconUrl: './images/red12.png'}),
                    blueIcon = new anyIcon({iconUrl: './images/blue02.png'}),
                    blueIcon01 = new anyIcon({iconUrl: './images/blue05.png'}),
                    blueIcon02 = new anyIcon({iconUrl: './images/blue03.png'}),
                    blueIcon03 = new anyIcon({iconUrl: './images/blue.png'}),
                    yellowIcon = new anyIcon({iconUrl: './images/yellow.png'});
                    greyIcon = new anyIcon({iconUrl:"./images/grey.png"});
                    empty= new  anyIcon({iconUrl:"./images/Empty.png"});

                    var [
                            Xingzai,
                            Yongchang,
                            Fuzhou_City,
                            Tibet,
                            Qarajang_City,
                            Jiandu,
                            Xiezhou,
                            Xiangyangfu,
                            Daidu,
                            Chengdufu,
                            Zhenzhou,
                            Zayton,
                            Fuling,
                            Yachi,
                            Dongpingfu,
                            Fuzhou_Kingdom,
                            Changzhou,
                            ChangAnfu,
                            Suzhou,
                            Guazhou,
                            Xinzhou_Matou,
                            Tingzhou,
                            Jianningfu,
                            Changlu,
                            Yangzhou,
                            Zhenjiangfu,
                            Hejianfu,
                            HuaiAnzhou,
                            Guangyuan,
                            Houguan,
                            Aq_Baliq,
                            Aq_Baliq_Manzi,
                            Liucheng,
                            Taiyuanfu,
                            Baoying,
                            Anqing,
                            Taizhou,
                            Jiangling,
                            Ganpu,
                            Gaoyou,
                            Suichang,
                            Hezhongfu,
                            Pizhou,
                            Quzhou,
                            Suqian,
                            Tonglu,
                            Tongzhou,
                            Changxing,
                            Zhuozhou,
                            Wuxing,
                            Chuzhou,
                            Wuzhou,
                            Wujiang,
                            Pingyangfu,
                            Zardandan,
                            Kuizhou,
                            Huaiyin,
                            Qarajang_Kingdom
                        ] = columnValues;



                /*var Xingzai, Yongchang, Fuzhou_City, Tibet, Qarajang_City, Jiandu, Xiezhou, Xiangyangfu, Daidu, Chengdufu, Zhenzhou, Zayton, Fuling, Yachi, Dongpingfu, Fuzhou_Kingdom, Changzhou, ChangAnfu, Suzhou, Guazhou, Xinzhou_Matou, Tingzhou, Jianningfu, Changlu, Yangzhou, Zhenjiangfu, Hejianfu, HuaiAnzhou, Guangyuan, Houguan, Aq_Baliq, Aq_Baliq_Manzi, Liucheng, Taiyuanfu, Baoying, Anqing, Taizhou, Jiangling, Ganpu, Gaoyou, Suichang, Hezhongfu, Pizhou, Quzhou, Suqian, Tonglu, Tongzhou, Changxing, Zhuozhou, Wuxing, Chuzhou, Wuzhou, Wujiang, Pingyangfu, Zardandan, Kuizhou, Huaiyin, Qarajang_Kingdom;
                let success = false;

                while (!success) {
                    try {
                        [
                            Xingzai,
                            Yongchang,
                            Fuzhou_City,
                            Tibet,
                            Qarajang_City,
                            Jiandu,
                            Xiezhou,
                            Xiangyangfu,
                            Daidu,
                            Chengdufu,
                            Zhenzhou,
                            Zayton,
                            Fuling,
                            Yachi,
                            Dongpingfu,
                            Fuzhou_Kingdom,
                            Changzhou,
                            ChangAnfu,
                            Suzhou,
                            Guazhou,
                            Xinzhou_Matou,
                            Tingzhou,
                            Jianningfu,
                            Changlu,
                            Yangzhou,
                            Zhenjiangfu,
                            Hejianfu,
                            HuaiAnzhou,
                            Guangyuan,
                            Houguan,
                            Aq_Baliq,
                            Aq_Baliq_Manzi,
                            Liucheng,
                            Taiyuanfu,
                            Baoying,
                            Anqing,
                            Taizhou,
                            Jiangling,
                            Ganpu,
                            Gaoyou,
                            Suichang,
                            Hezhongfu,
                            Pizhou,
                            Quzhou,
                            Suqian,
                            Tonglu,
                            Tongzhou,
                            Changxing,
                            Zhuozhou,
                            Wuxing,
                            Chuzhou,
                            Wuzhou,
                            Wujiang,
                            Pingyangfu,
                            Zardandan,
                            Kuizhou,
                            Huaiyin,
                            Qarajang_Kingdom
                        ] = columnValues;
                        success = true;
                    } catch (error) {
                        
                    }
                }*/
                                

                const original_markers = Object.freeze([
                    {lat: 28.462896451430616, lng: 118.21728517301383, icon:blueIcon, popupContent: 0},//Xingzai
                    {lat: 0, lng: 0, icon:greyIcon,  popupContent: 1},//Yongchang
                    {lat: 25.20096498200756, lng: 118.43701171455908, icon:blueIcon, popupContent: 2},//Fuzhou_City
                    {lat: 0, lng: 0, icon:greyIcon,  popupContent: 3},//Tibet
                    {lat: 0, lng: 0, icon:greyIcon,  popupContent: 4},//Qarajang_City
                    {lat: 0, lng: 0, icon:greyIcon,  popupContent: 5},//Jiandu
                    {lat: 34.93638266555324, lng: 109.94458007393405, icon:blueIcon,  popupContent: 6},//Xiezhou
                    {lat: 30.234391407813202, lng: 110.39501954801383, icon:blueIcon,  popupContent: 7},//Xiangyangfu
                    {lat: 0, lng: 0, icon:greyIcon,  popupContent: 8},//Daidu
                    {lat: 30.091910087077462, lng: 102.02343751676382, icon:blueIcon,  popupContent: 9},//Chengdufu
                    {lat: 30.215405799706534, lng: 117.32739259488883, icon:blueIcon,  popupContent: 10},//Zhenzhou
                    {lat: 23.89990050209837, lng: 117.51416017301382, icon:blueIcon,  popupContent: 11},//Zayton
                    {lat: 29.3764310567375, lng: 106.15429689176382, icon:blueIcon,  popupContent: 12},//Fuling
                    {lat: 0, lng: 0, icon:greyIcon,  popupContent: 13},//Yachi
                    {lat: 25.437322005354392, lng: 118.27441406145228, icon:blueIcon,  popupContent: 15},//Fuzhou_Kingdom
                    {lat: 29.346748385638794, lng: 118.58312988071704, icon:blueIcon,  popupContent: 16},//Changzhou
                    {lat: 34.158181827044466, lng: 107.97802733955905, icon:blueIcon,  popupContent: 17},//ChangAnfu
                    {lat:  29.241353038543533, lng: 119.11596679477954, icon:blueIcon,  popupContent: 18},//Suzhou
                    {lat: 30.28895459732805, lng: 117.88714599504603, icon:greyIcon,  popupContent: 19},//Guazhou
                    {lat: 34.42775477275056, lng: 115.49047851352954, icon:blueIcon,  popupContent: 20},//Xinzhou_Matou
                    {lat: 25.169150729729605, lng: 115.42895506136121, icon:blueIcon,  popupContent: 21},//Tingzhou
                    {lat: 26.22346138961486, lng: 115.53881834261122, icon:blueIcon,  popupContent: 22},//Jianningfu
                    {lat: 39.16243739691719, lng: 116.6440429352224, icon:blueIcon,  popupContent: 23},//Changlu
                    {lat: 30.422150902195295, lng: 117.87835692521186, icon:blueIcon,  popupContent: 24},//Yangzhou
                    {lat: 29.8396909258744, lng: 117.84045408479871, icon:blueIcon,  popupContent: 25},//Zhenjiangfu
                    {lat: 38.477674560489724, lng: 115.2158202789724, icon:blueIcon,  popupContent: 26},//Hejianfu
                    {lat: 30.98891162142395, lng: 117.72180174943061, icon:blueIcon,  popupContent: 27},//HuaiAnzhou
                    {lat: 31.838366019860075, lng: 104.6359862945974, icon:blueIcon,  popupContent: 28},//Guangyuan
                    {lat: 25.184561784536438, lng: 118.14477538224311, icon:blueIcon,  popupContent: 29},//Houguan
                    {lat: 39.00894014778241, lng: 113.2932128570974, icon:blueIcon,  popupContent: 30},//Aq_Baliq
                    {lat: 32.14585066537849, lng: 106.1081542633474, icon:blueIcon,  popupContent: 31},//Aq_Baliq_Manzi
                    {lat: 33.273598383210654, lng: 116.1716308258474, icon:greyIcon,  popupContent: 32},//Liucheng
                    {lat: 38.237317198200095, lng: 111.90234373323621, icon:blueIcon,  popupContent: 33},//Taiyuanfu
                    {lat: 35.02819711207845, lng: 115.8969726227224, icon:blueIcon,  popupContent: 14},//Dongpingfu
                    {lat: 30.758830767273807, lng: 117.81408691196704, icon:greyIcon,  popupContent: 34},//Baoying
                    {lat: 29.472122570267135, lng: 114.80822752229871, icon:blueIcon,  popupContent: 35},//Anqing
                    {lat: 30.29132621567163, lng: 118.60400388948621, icon:blueIcon,  popupContent: 36},//Taizhou
                    {lat: 37.01483496665293, lng: 115.91784666292371, icon:blueIcon,  popupContent: 37},//Jiangling
                    {lat: 28.658779132996656, lng: 119.37524413224311, icon:greyIcon,  popupContent: 38},//Ganpu
                    {lat: 30.68941547544074, lng: 118.00744628068061, icon:blueIcon,  popupContent: 39},//Gaoyou
                    {lat: 36.45486871320746, lng: 110.4257812164724, icon:blueIcon,  popupContent: 41},//Hezhongfu
                    {lat: 27.027324130533298, lng: 117.69158934708686, icon:greyIcon,  popupContent: 40},//Suichang
                    {lat: 32.09002109442789, lng: 117.08898925571704, icon:greyIcon,  popupContent: 42},//Pizhou
                    {lat: 27.681582325137093, lng: 116.7429198883474, icon:blueIcon,  popupContent: 43},//Quzhou
                    {lat: 32.03508870639029, lng: 117.34057615511122, icon:blueIcon,  popupContent: 44},//Suqian
                    {lat: 28.215353591268574, lng: 117.7097167633474, icon:blueIcon,  popupContent: 45},//Tonglu
                    {lat: 29.905424693620244, lng: 119.73120113834739, icon:blueIcon,  popupContent: 46},//Tongzhou
                    {lat: 28.992766254563122, lng: 118.08215330354872, icon:blueIcon,  popupContent: 47},//Changxing
                    {lat: 40.95252213976489, lng: 115.05212401505561, icon:blueIcon,  popupContent: 48},//Zhuozhou
                    {lat: 29.557689977215542, lng: 118.9712219196372, icon:blueIcon,  popupContent: 49},//Wuxing
                    {lat: 27.018026553504075, lng: 117.9184569977224, icon:blueIcon,  popupContent: 50},//Chuzhou
                    {lat: 27.512169047288076, lng: 117.69763181917371, icon:blueIcon,  popupContent: 51},//Wuzhou
                    {lat: 28.987961377194683, lng: 119.40051267854872, icon:blueIcon,  popupContent: 52},//Wujiang
                    {lat: 35.54831760186836, lng: 110.86523434147239, icon:blueIcon,  popupContent: 53},//Pingyangfu
                    {lat: 0, lng: 0, icon:greyIcon,  popupContent: 54},//Zardandan
                    {lat: 29.476904779644936, lng: 108.12304685823621, icon:blueIcon,  popupContent: 55},//Kuizhou
                    {lat: 30.90599533496887, lng: 117.69763181917371, icon:blueIcon,  popupContent: 56},//Huaiyin
                    {lat: 0, lng: 0, icon:greyIcon,  popupContent: 57}//Qarajang-Kingdom
                ]);

                function copyMarker(marker) {
                    return {
                        lat: marker.lat,
                        lng: marker.lng,
                        icon: L.icon(marker.icon.options),
                        popupContent: marker.popupContent
                    };
                }

                var current_markers = original_markers.map(copyMarker);

                var location_overview=[
                    Xingzai,
                    Yongchang,
                    Fuzhou_City,
                    Tibet,
                    Qarajang_City,
                    Jiandu,
                    Xiezhou,
                    Xiangyangfu,
                    Daidu,
                    Chengdufu,
                    Zhenzhou,
                    Zayton
                ]
                
                var idolaters_list=[
                    Xingzai,
                    Yongchang,
                    Fuzhou_City,
                    Tibet,
                    Qarajang_City,
                    Jiandu,
                    Xiangyangfu,
                    Chengdufu,
                    Zhenzhou,
                    Zayton,
                    Fuling,
                    Yachi,
                    Fuzhou_Kingdom,
                    Changzhou,
                    ChangAnfu,
                    Suzhou,
                    Guazhou,
                    Xinzhou_Matou,
                    Changlu,
                    Yangzhou,
                    Zhenjiangfu,
                    Hejianfu,
                    HuaiAnzhou,
                    Guangyuan,
                    Aq_Baliq_Manzi,
                    Qarajang_Kingdom,
                    Baoying,
                    Anqing,
                    Taizhou,
                    Jiangling,
                    Gaoyou,
                    Suichang,
                    Hezhongfu,
                    Quzhou,
                    Suqian,
                    Tonglu,
                    Tongzhou,
                    Changxing,
                    Zhuozhou,
                    Wuxing,
                    Chuzhou,
                    Wuzhou
                ]

                var nes_christ_list=[
                    Baoying,
                    Zhenjiangfu,
                    Xingzai,
                    Yachi,
                    Guangyuan,
                    Daidu,
                    ChangAnfu,
                    Hejianfu
                ]

                var christ_list=[
                    
                ]

                var sar_list=[
                    Yachi,
                    Daidu,
                    ChangAnfu,
                    Guangyuan
                ]

                var industry_list=[
                    Chengdufu,
                    ChangAnfu,
                    Taiyuanfu,
                    Hezhongfu,
                    Wujiang,
                    Xingzai,
                    Fuzhou_City,
                    Xiangyangfu,
                    Zayton,
                    Fuling,
                    Yachi,
                    Fuzhou_Kingdom,
                    Changzhou,
                    Suzhou,
                    Xinzhou_Matou,
                    Jianningfu,
                    Yangzhou,
                    Zhenjiangfu,
                    Hejianfu,
                    Aq_Baliq_Manzi,
                    Liucheng,
                    Baoying,
                    Anqing,
                    Taizhou,
                    Gaoyou,
                    Suichang,
                    Pizhou,
                    Quzhou,
                    Suqian,
                    Changxing,
                    Zhuozhou,
                    Wuxing,
                    Wuzhou,
                    Pingyangfu,
                    Tonglu
                ]

                var sugar_list=[
                    Houguan,
                    Xingzai,
                    Fuzhou_City
                ]

                var agri_list=[
                    Chengdufu,
                    Guangyuan,
                    Qarajang_Kingdom
                ]

                var prostitute_list=[
                    Xingzai
                ]

                var ship_list=[
                    Zhenzhou,
                    Zayton,
                    Xinzhou_Matou,
                    HuaiAnzhou,
                    Liucheng,
                    Taizhou,
                    Ganpu
                ]

                var herd_list=[
                    Tibet,
                    Qarajang_Kingdom
                ]

                var trade_list=[
                    Xingzai,
                    Fuzhou_City,
                    Xiangyangfu,
                    Daidu,
                    Zhenzhou,
                    Zayton,
                    Fuling,
                    Yachi,
                    Fuzhou_Kingdom,
                    Changzhou,
                    ChangAnfu,
                    Suzhou,
                    Xinzhou_Matou,
                    Jianningfu,
                    Yangzhou,
                    Zhenjiangfu,
                    Hejianfu,
                    HuaiAnzhou,
                    Aq_Baliq_Manzi,
                    Liucheng,
                    Taiyuanfu,
                    Dongpingfu,
                    Baoying,
                    Anqing,
                    Taizhou,
                    Jiangling,
                    Gaoyou,
                    Suichang,
                    Hezhongfu,
                    Pizhou,
                    Quzhou,
                    Suqian,
                    Tonglu,
                    Changxing,
                    Zhuozhou,
                    Wuxing,
                    Wuzhou,
                    Wujiang,
                    Pingyangfu
                ]

                var military_list=[
                    Xingzai,
                    Liucheng
                ]

                var hunt_list=[
                    Tibet,
                    Guangyuan,
                    Aq_Baliq
                ]

                var salt_list=[
                    Xingzai,
                    Zhenzhou,
                    Yachi,
                    Changlu,
                    HuaiAnzhou,
                    Tongzhou
                ]

                var literati_list=[
                    Xingzai,
                    Suzhou
                ]

                var occult_list=[
                    Xingzai,
                    Tibet,
                    Daidu
                ]

                var lux_list=[
                    Xingzai,
                    Fuzhou_City,
                    Tibet,
                    Qarajang_City,
                    Jiandu,
                    Zayton,
                    Fuzhou_Kingdom,
                    Suzhou,
                    Jianningfu,
                    Houguan,
                    Aq_Baliq_Manzi,
                    Jiangling,
                    Hezhongfu
                ]

                var ani_list=[
                    Fuzhou_City,
                    Tibet,
                    Qarajang_City,
                    Jiandu,
                    Xiangyangfu,
                    Chengdufu,
                    Fuling,
                    Yachi,
                    Fuzhou_Kingdom,
                    Changzhou,
                    Jianningfu,
                    Zhenjiangfu,
                    Guangyuan,
                    Aq_Baliq,
                    Liucheng,
                    Qarajang_Kingdom,
                    Anqing,
                    Taizhou,
                    Gaoyou,
                    Changxing
                ]

                var mili_list=[
                    ChangAnfu,
                    Yangzhou,
                    Taiyuanfu
                ]

                var agri_pro_list=[
                    Tibet,
                    Guazhou,
                    Changlu,
                    Zhenjiangfu,
                    Aq_Baliq_Manzi,
                    Liucheng,
                    Dongpingfu,
                    Anqing,
                    Suqian
                ]

                var craft_list=[
                    Xingzai,
                    Yongchang,
                    Jiandu,
                    Daidu,
                    Xiangyangfu,
                    Chengdufu,
                    Fuling,
                    ChangAnfu,
                    Suzhou,
                    Xinzhou_Matou,
                    Tingzhou,
                    Jianningfu,
                    Zhenjiangfu,
                    Hejianfu,
                    HuaiAnzhou,
                    Taiyuanfu,
                    Dongpingfu,
                    Baoying,
                    Anqing,
                    Taizhou,
                    Jiangling,
                    Ganpu,
                    Hezhongfu,
                    Pizhou,
                    Quzhou,
                    Changxing,
                    Zhuozhou,
                    Wuxing,
                    Pingyangfu
                ]
            

                
                function marker_setup(){
                    // Loop through the markers array and create a marker for each object
                    for (var i = 0; i < current_markers.length; i++) {
                        var marker = L.marker([current_markers[i].lat, current_markers[i].lng],{icon:current_markers[i].icon, opacity:0.7}).addTo(map);
                        marker.bindPopup(columnValues[current_markers[i].popupContent],{
                            closeButton: false,
                            className:'stylePopup'
                        });
                        marker.on('mouseover',function (e) {
                            this.openPopup();
                            this.setOpacity(1)
                        });
                        marker.on('mouseout', function (e) {
                            this.closePopup();
                            this.setOpacity(0.7)
                        });
                        marker.on('click',function(e) {
                            if (location_overview.includes(this._popup._content)){
                                console.log(this._popup._content);
                            $("#"+this._popup._content).click();
                            $('html, body').stop().animate({
                                scrollTop: $("#page_4").offset().top
                            }, {
                                duration:100,
                                easing: 'linear'
                            });
                            }
                        })
                    };
                }
                marker_setup()
                

                function overview_map(){
                    updateMarkerIcons(greenIcon,"overview");
                }

                function return_map(){
                    updateMarkerIcons(greyIcon,"return");
                }

                function button_start(){
                    plt_width=window.innerwidth*0.4
                    updateMarkerIcons(greyIcon,"none");
                }

                function religion_map(religion_value,back_value){
                    console.log(back_value)
                    if (back_value===0){
                        if(religion_value==="Idolaters"){
                            updateMarkerIcons(blueIcon,"religion");
                        } else if(religion_value==="Nestorian Christians"){
                            updateMarkerIcons(blueIcon01,"religion");
                        }else if(religion_value==="Christians"){
                            updateMarkerIcons(blueIcon02,"religion");
                        }else if(religion_value==="Saracens"){
                            updateMarkerIcons(blueIcon03,"religion");
                        }
                    }else{
                        updateMarkerIcons(greyIcon,"none");
                    }
                    
                }

                function economics_map(economics_value,back_value){
                    if (back_value===0){
                        if(economics_value==="Industry"){
                            updateMarkerIcons(redIcon,"economics");
                        } else if(economics_value==="Sugar"){
                            updateMarkerIcons(redIcon01,"economics");
                        }else if(economics_value==="Agriculture"){
                            updateMarkerIcons(redIcon02,"economics");
                        }else if(economics_value==="Prostitute"){
                            updateMarkerIcons(redIcon03,"economics");
                        }else if(economics_value==="Shipping"){
                            updateMarkerIcons(redIcon04,"economics");
                        }else if(economics_value==="Herding"){
                            updateMarkerIcons(redIcon05,"economics");
                        }else if(economics_value==="Trade"){
                            updateMarkerIcons(redIcon06,"economics");
                        }else if(economics_value==="Military"){
                            updateMarkerIcons(redIcon07,"economics");
                        }else if(economics_value==="Hunting"){
                            updateMarkerIcons(redIcon08,"economics");
                        }else if(economics_value==="Salt"){
                            updateMarkerIcons(redIcon09,"economics");
                        }else if(economics_value==="literati"){
                            updateMarkerIcons(redIcon10,"economics");
                        }else if(economics_value==="occult"){
                            updateMarkerIcons(redIcon11,"economics");
                        }
                    }else{
                        updateMarkerIcons(greyIcon,"none");
                    }
                }

                function specialty_map(specialty_value,back_value){
                    if (back_value===0){
                        if(specialty_value==="Luxury goods"){
                            updateMarkerIcons(greenIcon,"specialty");
                        } else if(specialty_value==="Animal or Animal Products"){
                            updateMarkerIcons(greenIcon01,"specialty");
                        }else if(specialty_value==="Military Equipments"){
                            updateMarkerIcons(greenIcon02,"specialty");
                        }else if(specialty_value==="Agricultural Products"){
                            updateMarkerIcons(greenIcon03,"specialty");
                        }else if(specialty_value==="Crafted Items"){
                            updateMarkerIcons(greenIcon04,"specialty");
                        }
                    }else{
                        updateMarkerIcons(greyIcon,"none");
                    }
                }


                function updateMarkerIcons(color,check) {
                    // Loop through the markers array and update the icon property
                    current_markers.forEach(function(marker) {
                        if (check==="overview"){
                            if (location_overview.includes(columnValues[marker.popupContent])) {
                                marker.icon = color;
                            } else {
                                marker.icon = greyIcon;
                            }
                        }else if (check==="return"){
                            for (var i=0;i<original_markers.length;i++){
                                if (columnValues[marker.popupContent]==columnValues[original_markers[i].popupContent]){
                                    marker.icon=original_markers[i].icon
                                }
                            }
                        }else if (check==="religion"){
                            if (color===blueIcon){
                                if (idolaters_list.includes(columnValues[marker.popupContent])) {
                                    marker.icon = color;
                                } else {
                                    marker.icon = empty;
                                }
                            }else if(color===blueIcon01){
                                if (nes_christ_list.includes(columnValues[marker.popupContent])) {
                                    marker.icon = color;
                                } else {
                                    marker.icon = empty;
                                }
                            }else if(color===blueIcon02){
                                if (christ_list.includes(columnValues[marker.popupContent])) {
                                    marker.icon = color;
                                } else {
                                    marker.icon = empty;
                                }
                            }else if(color===blueIcon03){
                                if (sar_list.includes(columnValues[marker.popupContent])) {
                                    marker.icon = color;
                                } else {
                                    marker.icon = empty;
                                }
                            }

                        }else if (check==="none"){
                            marker.icon=greyIcon;

                        }else if (check==="economics"){
                            if (color===redIcon){
                                if (industry_list.includes(columnValues[marker.popupContent])) {
                                    marker.icon = color;
                                } else {
                                    marker.icon = empty;
                                }
                            }else if(color===redIcon01){
                                if (sugar_list.includes(columnValues[marker.popupContent])) {
                                    marker.icon = color;
                                } else {
                                    marker.icon = empty;
                                }
                            }else if(color===redIcon02){
                                if (agri_list.includes(columnValues[marker.popupContent])) {
                                    marker.icon = color;
                                } else {
                                    marker.icon = empty;
                                }
                            }else if(color===redIcon03){
                                if (prostitute_list.includes(columnValues[marker.popupContent])) {
                                    marker.icon = color;
                                } else {
                                    marker.icon = empty;
                                }
                            }else if(color===redIcon04){
                                if (ship_list.includes(columnValues[marker.popupContent])) {
                                    marker.icon = color;
                                } else {
                                    marker.icon = empty;
                                }
                            }else if(color===redIcon05){
                                if (herd_list.includes(columnValues[marker.popupContent])) {
                                    marker.icon = color;
                                } else {
                                    marker.icon = empty;
                                }
                            }else if(color===redIcon06){
                                if (trade_list.includes(columnValues[marker.popupContent])) {
                                    marker.icon = color;
                                } else {
                                    marker.icon = empty;
                                }
                            }else if(color===redIcon07){
                                if (military_list.includes(columnValues[marker.popupContent])) {
                                    marker.icon = color;
                                } else {
                                    marker.icon = empty;
                                }
                            }else if(color===redIcon08){
                                if (hunt_list.includes(columnValues[marker.popupContent])) {
                                    marker.icon = color;
                                } else {
                                    marker.icon = empty;
                                }
                            }else if(color===redIcon09){
                                if (salt_list.includes(columnValues[marker.popupContent])) {
                                    marker.icon = color;
                                } else {
                                    marker.icon = empty;
                                }
                            }else if(color===redIcon10){
                                if (literati_list.includes(columnValues[marker.popupContent])) {
                                    marker.icon = color;
                                } else {
                                    marker.icon = empty;
                                }
                            }else if(color===redIcon11){
                                if (occult_list.includes(columnValues[marker.popupContent])) {
                                    marker.icon = color;
                                } else {
                                    marker.icon = empty;
                                }
                            }


                        }

                        else if (check==="specialty"){
                            if (color===greenIcon){
                                if (lux_list.includes(columnValues[marker.popupContent])) {
                                    marker.icon = color;
                                } else {
                                    marker.icon = empty;
                                }
                            }else if(color===greenIcon01){
                                if (ani_list.includes(columnValues[marker.popupContent])) {
                                    marker.icon = color;
                                } else {
                                    marker.icon = empty;
                                }
                            }else if(color===greenIcon02){
                                if (mili_list.includes(columnValues[marker.popupContent])) {
                                    marker.icon = color;
                                } else {
                                    marker.icon = empty;
                                }
                            }else if(color===greenIcon03){
                                if (agri_pro_list.includes(columnValues[marker.popupContent])) {
                                    marker.icon = color;
                                } else {
                                    marker.icon = empty;
                                }
                            }else if(color===greenIcon04){
                                if (craft_list.includes(columnValues[marker.popupContent])) {
                                    marker.icon = color;
                                } else {
                                    marker.icon = empty;
                                }
                            }
                        }


                    });
                    // Loop through the marker layers on the map and update the icon
                    map.eachLayer(function(layer) {
                        if (layer instanceof L.Marker) {
                            var marker = current_markers.find(function(m) {
                                return columnValues[m.popupContent] === layer.getPopup().getContent();
                            });
                            layer.setIcon(marker.icon);
                        }
                    });
                }
        
            </script>
    </section>


    <section id="connect1" style="height:250px; position: relative;">
        <img src="./images/pattern02.png" style="position: absolute; bottom: 0; left: 0%; width: 20%; height: 250px;z-index: 0">
        <img src="./images/pattern02.png" style="position: absolute; bottom: 0; left: 20%; width: 20%; height: 250px;z-index: 0">
        <img src="./images/pattern02.png" style="position: absolute; bottom: 0; left: 40%; width: 20%; height: 250px;z-index: 0">
        <img src="./images/pattern02.png" style="position: absolute; bottom: 0; left: 60%; width: 20%; height: 250px;z-index: 0">
        <img src="./images/pattern02.png" style="position: absolute; bottom: 0; left: 80%; width: 20%; height: 250px;z-index: 0">
        <span style="position: absolute; top: 0; left: 0; height: 50px; width: 100%; background-color: #b9ddff;z-index: 1;"></span>
    </section>

    <section class="section-padding section-bg3" style="height: 715px;" id="page_4">
        <div class="container">
            <div style="margin-top:5px;margin-bottom:5px;text-align:center;">
                <img id="scrollToMap" class="arrow" src="./images/arrow.png"style="width:20px; height:20px;margin-top:2px;text-align:center;z-index: 1;" >
            </div>
            <div style="margin-top:10px;margin-bottom:10px;text-align:center; ">

                <div class="section-1" style="display:inline-block;">
                    <h1 style="text-align:center"><b  id="title_1"></b></h1>
                    <div style="float:left; width:49%;height:600px">
                        <img class="shape" src="./images/xingzai.jpg">
                    </div>
                    <div style="float:left; width:2%;height:570px"></div>
                    <div style="float:right; width:49%;height:570px">
                        <div id="draw_box_1" style="margin-left:20px;height:100%;width:100%">
                            <svg id='rectangle' class="my-svg-1" width="100%" height="100%">
                                <rect id='stroke'class="my-rec-1" stroke="#3e5e88" rx='50' ry='50'/>
                            <switch>
                                <foreignObject width="100%" height="100%" >
                                    <p id="text-1" class="narrative_bar"><br>&ensp; &ensp; In his narrative, Marco calls Xingzai "the city of Heaven". This may have been influenced by the Chinese proverb "There is a paradise above, and a Suzhou-Hangzhou below," which suggests that there are earthly paradises that are just as beautiful as heaven.At the same time he gives a direct justification for the notation of Xingzai,"it is well worth recording, because this is without doubt the finest and noblest city in the world." <br>&ensp; &ensp; Marco Polo offers a comprehensive description of the city of xingzai, including its architecture, the arrangement of its streets, the state of its commerce and handicrafts, the wedding and funeral customs of its inhabitants, the city's fire protection system, and even the income of the Great Khan.</p>
                                    <p class="button-return" style="height:5%;position:fixed;bottom:20px" ><u>Click to See More</u></p>
                                </foreignObject>
                            </switch>
                            </svg>
                        </div>
                    </div>
                </div>
                
        
                <div class="section-2" style="display:none;">
                    <h1 style="text-align:center"><b  id="title_2"></b></h1>
                    <div style="float:left; width:49%;height:600px">
                        <img class="shape" src="./images/baoshan.jpg">
                    </div>
                    <div style="float:left; width:2%;height:570px"></div>
                    <div style="float:right; width:49%;height:570px">
                        <div id="draw_box_2" style="margin-left:20px;height:100%;width:100%">
                            <svg id='rectangle' class="my-svg-2" width="100%" height="100%">
                                <rect id='stroke'class="my-rec-2" stroke="#3e5e88" rx='50' ry='50'/>
                            <switch>
                                <foreignObject width="100%" height="100%" >
                                    <p id="text-2" class="narrative_bar"><br>&ensp; &ensp; The teeth of the people of Yongchang are covered with gold. "These people do not have idols or churches but worship the head of the house" and "there are no physicians. When someone falls ill he sends for the magicians."<br>&ensp;&ensp; Marco Polo provides a detailed account of the unique customs of the region, including Couvade, the process of healing by magicians, and the wars between the armies of the Khan and those of the king of Myanmar and Bengal. The custom of Yongchang described by Marco Polo is consistent with historical data, which supports the authenticity of his account.</p>
                                    <p class="button-return" style="height:5%;position:fixed;bottom:20px" ><u>Click to See More</u></p>
                                </foreignObject>
                            </switch>
                            </svg>
                        </div>
                    </div>
                </div>
        
                <div class="section-3"  style="display:none" >
                    <h1 style="text-align:center"><b  id="title_3"></b></h1>
                    <div style=" float:left; width:49%;height:600px">
                        <img class="shape" src="./images/fuzhou.jpg" >
                    </div>
                    <div style="float:left; width:2%;height:570px"></div>
                    <div style=" float:right; width:49%;height:570px">
                        <div id="draw_box_3" style="margin-left:20px;height:100%;width:100%">
                            <svg id='rectangle' class="my-svg-3" width="100%" height="100%">
                                <rect id='stroke'class="my-rec-3" stroke="#3e5e88" rx='50' ry='50'/>
                            <switch>
                                <foreignObject width="100%" height="100%" >
                                    <p id="text-3" class="narrative_bar"><br>&ensp; &ensp; When Marco Polo wrote about Fuzhou, he described the local people's methods of capturing lions and papiones. In Marco's eyes, "it is such a fine city and so well ordered in every respect that it is marvelous beyond words." In addition to describing the local industries and special products, he also mentioned that "there is a sect of people whose religion is a mystery to everyone".<br>&ensp;&ensp;Through persistent visits, Marco and his uncle were eventually able to communicate with the members of this sect. After examining their beliefs, Marco Polo and his uncle concluded that these people were likely Christians.</p>
                                    <p class="button-return" style="height:5%;position:fixed;bottom:20px" ><u>Click to See More</u></p>
                                </foreignObject>
                            </switch>
                            </svg>
                        </div>

                    </div>
                </div>
        
                <div class="section-4"  style="display:none">
                    <h1 style="text-align:center"><b  id="title_4"></b></h1>
                    <div style=" float:left; width:49%;height:600px">
                        <img class="shape" src="./images/Tibet.jpg" >
                    </div>
                    <div style="float:left; width:2%;height:570px"></div>
                    <div style=" float:right; width:49%;height:570px">
                        <div id="draw_box_4" style="margin-left:20px;height:100%;width:100%">
                            <svg id='rectangle' class="my-svg-4" width="100%" height="100%">
                                <rect id='stroke'class="my-rec-4" stroke="#3e5e88" rx='50' ry='50'/>
                            <switch>
                                <foreignObject width="100%" height="100%" >
                                    <p id="text-4" class="narrative_bar"><br>&ensp; &ensp; As an experienced traveling merchant, Marco Polo provides detailed descriptions of the protective measures taken by merchants while traversing through the wilderness. For instance, he describes the practice of throwing bamboo sticks into the fire to create a loud explosion that scares away wild beasts.<br>&ensp; &ensp; In addition to these protective measures, Marco Polo also notes various local customs, he mentions that local people refuse to take virgins as wives. Instead, mothers send their daughters to spend the night with passing merchants, and the woman who receives the most souvenirs is considered the most desirable marriage partner. Marco also mentions “They have no coinage and do not use the Great Khan's paper money but instead use salt as a currency.”</p>
                                    <p class="button-return" style="height:5%;position:fixed;bottom:20px" ><u>Click to See More</u></p>
                                </foreignObject>
                            </switch>
                            </svg>
                        </div>
                    </div>
                </div>

                <div class="section-5"  style="display:none">
                    <h1 style="text-align:center"><b  id="title_5"></b></h1>
                    <div style=" float:left; width:49%;height:600px">
                        <img class="shape" src="./images/Dali.jpg" >
                    </div>
                    <div style="float:left; width:2%;height:570px"></div>
                    <div style=" float:right; width:49%;height:570px">
                        <div id="draw_box_5" style="margin-left:20px;height:100%;width:100%">
                            <svg id='rectangle' class="my-svg-5" width="100%" height="100%">
                                <rect id='stroke'class="my-rec-5" stroke="#3e5e88" rx='50' ry='50'/>
                            <switch>
                                <foreignObject width="100%" height="100%" >
                                    <p id="text-5" class="narrative_bar"><br>&ensp; &ensp;Marco Polo devotes a significant portion of his narrative to describing the huge snakes of the Qarajang, including their capture methods and the medicinal properties of their bile.<br>&ensp; &ensp; He also tells of the evil customs of the region before the Khan's rule: "If it happened that a handsome gentleman or anyone with a superior air-a 'good shadow'-came to lodge in the house of an inhabitant of this province, they would murder him during the night by poison or other lethal means." This was because they believed that taking over the souls of the deceased would bless them.</p>
                                    <p class="button-return" style="height:5%;position:fixed;bottom:20px" ><u>Click to See More</u></p>
                                </foreignObject>
                            </switch>
                            </svg>
                        </div>
                    </div>
                </div>

                <div class="section-6"  style="display:none">
                    <h1 style="text-align:center"><b  id="title_6"></b></h1>
                    <div style=" float:left; width:49%;height:600px">
                        <img class="shape" src="./images/Xichang.jpg" >
                    </div>
                    <div style="float:left; width:2%;height:570px"></div>
                    <div style=" float:right; width:49%;height:570px">
                        <div id="draw_box_6" style="margin-left:20px;height:100%;width:100%">
                            <svg id='rectangle' class="my-svg-6" width="100%" height="100%">
                                <rect id='stroke'class="my-rec-6" stroke="#3e5e88" rx='50' ry='50'/>
                            <switch>
                                <foreignObject width="100%" height="100%" >
                                    <p id="text-6" class="narrative_bar"> <br>&ensp; &ensp; Jiandu also implemented the use of salt coins as a circulating currency. Marco Polo provides a detailed account of the process of creating salt coins, as well as the exchange rate between salt coins and gold coins. However, this exchange rate was not fixed and varied depending on the location. In more remote and less developed areas, fewer salt coins could be exchanged for a fixed number of gold coins. <br>&ensp; &ensp;In addition, Marco Polo describes a unique local custom in the area whereby men did not consider it an outrage if a foreigner or another man dishonored him with his wife, daughter, sister, or any woman under his roof. Outsiders would often hang out a sign to indicate a visit when they met with a local woman. Marco attributes this custom to idolatry, with believers thinking that their behavior would be appreciated by the gods.</p>
                                    <p class="button-return" style="height:5%;position:fixed;bottom:20px" ><u>Click to See More</u></p>
                                </foreignObject>
                            </switch>
                            </svg>
                        </div>
                    </div>
                </div>

                <div class="section-7"  style="display:none">
                    <h1 style="text-align:center"><b  id="title_7"></b></h1>
                    <div style=" float:left; width:49%;height:600px">
                        <img class="shape" src="./images/Xiezhou.jpg" >
                    </div>
                    <div style="float:left; width:2%;height:570px"></div>
                    <div style=" float:right; width:49%;height:570px">
                        <div id="draw_box_7" style="margin-left:20px;height:100%;width:100%">
                            <svg id='rectangle' class="my-svg-7" width="100%" height="100%">
                                <rect id='stroke'class="my-rec-7" stroke="#3e5e88" rx='50' ry='50'/>
                            <switch>
                                <foreignObject width="100%" height="100%" >
                                    <p id="text-7" class="narrative_bar"></p>
                                    <p class="button-return" style="height:5%;position:fixed;bottom:20px" ><u>Click to See More</u></p>
                                </foreignObject>
                            </switch>
                            </svg>
                        </div>
                    </div>
                </div>

                <div class="section-8"  style="display:none">
                    <h1 style="text-align:center"><b id="title_8"></b></h1>
                    <div style=" float:left; width:49%;height:600px">
                        <img class="shape" src="./images/xiangyangfu.jpg" >
                    </div>
                    <div style="float:left; width:2%;height:570px"></div>
                    <div style=" float:right; width:49%;height:570px">
                        <div id="draw_box_8" style="margin-left:20px;height:100%;width:100%">
                            <svg id='rectangle' class="my-svg-8" width="100%" height="100%">
                                <rect id='stroke'class="my-rec-8" stroke="#3e5e88" rx='50' ry='50'/>
                            <switch>
                                <foreignObject width="100%" height="100%" >
                                    <p id="text-8"class="narrative_bar"></p>
                                    <p class="button-return" style="height:5%;position:fixed;bottom:20px" ><u>Click to See More</u></p>
                                </foreignObject>
                            </switch>
                            </svg>
                        </div>
                    </div>
                </div>

                <div class="section-9"  style="display:none">
                    <h1 style="text-align:center"><b id="title_9"></b></h1>
                    <div style=" float:left; width:49%;height:600px">
                        <img class="shape" src="./images/daidu.jpg" >
                    </div>
                    <div style="float:left; width:2%;height:570px"></div>
                    <div style=" float:right; width:49%;height:570px">
                        <div id="draw_box_9" style="margin-left:20px;height:100%;width:100%">
                            <svg id='rectangle' class="my-svg-9" width="100%" height="100%">
                                <rect id='stroke'class="my-rec-9" stroke="#3e5e88" rx='50' ry='50'/>
                            <switch>
                                <foreignObject width="100%" height="100%" >
                                    <p id="text-9"class="narrative_bar"></p>
                                    <p class="button-return" style="height:5%;position:fixed;bottom:20px" ><u>Click to See More</u></p>
                                </foreignObject>
                            </switch>
                            </svg>
                        </div>
                    </div>
                </div>

                <div class="section-10"  style="display:none" >
                    <h1 style="text-align:center"><b id="title_10"></b></h1>
                    <div style=" float:left; width:49%;height:600px">
                        <img class="shape" src="./images/Chengdu.jpg" >
                    </div>
                    <div style="float:left; width:2%;height:570px"></div>
                    <div style=" float:right; width:49%;height:570px">
                        <div id="draw_box_10" style="margin-left:20px;height:100%;width:100%">
                            <svg id='rectangle' class="my-svg-10" width="100%" height="100%">
                                <rect id='stroke'class="my-rec-10" stroke="#3e5e88" rx='50' ry='50'/>
                            <switch>
                                <foreignObject width="100%" height="100%" >
                                    <p id="text-10" class="narrative_bar"></p>
                                    <p class="button-return" style="height:5%;position:fixed;bottom:20px" ><u>Click to See More</u></p>
                                </foreignObject>
                            </switch>
                            </svg>
                        </div>
                    </div>
                </div>

                <div class="section-11"  style="display:none">
                    <h1 style="text-align:center"><b id="title_11"></b></h1>
                    <div style=" float:left; width:49%;height:600px">
                        <img class="shape" src="./images/yizheng.jpg" >
                    </div>
                    <div style="float:left; width:2%;height:570px"></div>
                    <div style=" float:right; width:49%;height:570px">
                        <div id="draw_box_11" style="margin-left:20px;height:100%;width:100%">
                            <svg id='rectangle' class="my-svg-11" width="100%" height="100%">
                                <rect id='stroke'class="my-rec-11" stroke="#3e5e88" rx='50' ry='50'/>
                            <switch>
                                <foreignObject width="100%" height="100%" >
                                    <p id="text-11" class="narrative_bar"></p>
                                    <p class="button-return" style="height:5%;position:fixed;bottom:20px" ><u>Click to See More</u></p>
                                </foreignObject>
                            </switch>
                            </svg>
                        </div>
                    </div>
                </div>

                <div class="section-12"  style="display:none">
                    <h1 style="text-align:center"><b id="title_12"></b></h1>
                    <div style=" float:left; width:49%; height:600px">
                        <img class="shape" src="./images/quanzhou.jpg" >
                    </div>
                    <div style="float:left; width:2%;height:600px"></div>
                    <div style=" float:right; width:49%;height:570px">
                        <div id="draw_box_12" style="margin-left:20px;height:100%;width:100%">
                            <svg id='rectangle' class="my-svg-12" width="100%" height="100%">
                                <rect id='stroke'class="my-rec-12" stroke="#3e5e88" rx='50' ry='50'/>
                            <switch>
                                <foreignObject width="100%" height="100%" >
                                    <p id="text-12" class="narrative_bar">any text</p>
                                    <p class="button-return" style="height:5%;position:fixed;bottom:20px" ><u>Click to See More</u></p>
                                </foreignObject>
                            </switch>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    

        <script>
            var mapElement = document.getElementById("page_3");
            var arrowElement = document.getElementById("scrollToMap");
            arrowElement.addEventListener("click", function() {
                mapElement.scrollIntoView({ behavior: "smooth" });
            });
        </script>
        
    </section>

    <section class="align-items-center" style="height: 50px;width:100%" id="navbar">
        <div style="margin-top:0px">
            <div style="text-align:center; bottom:0px;">
                <span class="productbtn btn1 btn-click" data-action="section-1" id="Xingzai"></span>
                <span class="productbtn btn2 btn-click" data-action="section-2" id="Yongchang"></span>
                <span class="productbtn btn3 btn-click" data-action="section-3" id="Fuzhou-City"></span>
                <span class="productbtn btn4 btn-click" data-action="section-4" id="Tibet"></span>
                <span class="productbtn btn5 btn-click" data-action="section-5" id="Qarajang"></span>
                <span class="productbtn btn6 btn-click" data-action="section-6" id="Jiandu"></span>
                <span class="productbtn btn7 btn-click" data-action="section-7" id="Xiezhou"></span>
                <span class="productbtn btn8 btn-click" data-action="section-8" id="Xiangyangfu"></span>
                <span class="productbtn btn9 btn-click" data-action="section-9" id="Daidu"></span>
                <span class="productbtn btn10 btn-click" data-action="section-10" id="Chengdufu"></span>
                <span class="productbtn btn11 btn-click" data-action="section-11" id="Zhenzhou"></span>
                <span class="productbtn btn12 btn-click" data-action="section-12" id="Zayton"></span>
            </div>
            <script>
                $(function(){
                    $(".btn-click").click(function(){
                        var target = $(this).data("action");
                    $("."+target).show().siblings("div[class*=section-]").hide();
                })
                }); 
    
                $(function() {
                // Get all the buttons with class "btn"
                var buttons = $(".btn");
    
                // Iterate over each button
                buttons.each(function(index) {
                    // Get the corresponding section with class "section-{index+1}"
                    var section = $(".section-" + (index+1));
    
                    // Add a click event listener to the button
                    $(this).click(function() {
                    // Hide all sections except the current one
                    $(".section-").not(section).hide();
    
                    // Show the current section
                    section.show();
                    });
                });
                });

                for(var i=1;i<=12;i++){
                // Get the SVG and rectangle elements
                const svg_rect = document.querySelector(`.my-svg-${i}`);
                const rect = document.querySelector(`.my-rec-${i}`);
                // Define the resize function
                function resize() {
                    const width = svg_rect.clientWidth;
                    const height = svg_rect.clientHeight;
                    rect.setAttribute('width', width);
                    rect.setAttribute('height', height);
                }
                // Add the resize event listener and call the function
                window.addEventListener('resize', resize);
                resize();
                // Add the animationend event listener to show the text
                const text = document.querySelector(`#text-${i}`);
                svg_rect.addEventListener('animationend', function(ev) {
                    if (ev.animationName === 'fillIn') {
                    text.style.display = 'flex';
                    }
                });


                }

                for (i=1;i<=12;i++){
                    var elementId = 'title_' + i;
                    document.getElementById(elementId).textContent = columnValues[i-1];
                }

                var check_1=0;
                const textBox_1 = document.getElementById('draw_box_1');
                const textCont_1 = document.getElementById('text-1');

                var check_2=0;
                const textBox_2 = document.getElementById('draw_box_2');
                const textCont_2 = document.getElementById('text-2');

                var check_3=0;
                const textBox_3 = document.getElementById('draw_box_3');
                const textCont_3 = document.getElementById('text-3');

                var check_4=0;
                const textBox_4 = document.getElementById('draw_box_4');
                const textCont_4 = document.getElementById('text-4');

                var check_5=0;
                const textBox_5 = document.getElementById('draw_box_5');
                const textCont_5 = document.getElementById('text-5');

                var check_6=0;
                const textBox_6 = document.getElementById('draw_box_6');
                const textCont_6 = document.getElementById('text-6');

                var check_7=0;
                const textBox_7 = document.getElementById('draw_box_7');
                const textCont_7 = document.getElementById('text-7');

                var check_8=0;
                const textBox_8 = document.getElementById('draw_box_8');
                const textCont_8 = document.getElementById('text-8');

                var check_9=0;
                const textBox_9 = document.getElementById('draw_box_9');
                const textCont_9 = document.getElementById('text-9');

                var check_10=0;
                const textBox_10 = document.getElementById('draw_box_10');
                const textCont_10 = document.getElementById('text-10');

                var check_11=0;
                const textBox_11 = document.getElementById('draw_box_11');
                const textCont_11 = document.getElementById('text-11');

                var check_12=0;
                const textBox_12 = document.getElementById('draw_box_12');
                const textCont_12 = document.getElementById('text-12');

                textBox_1.addEventListener('click', function() {
                    if (check_1==1){
                        textCont_1.innerHTML = "<br>&ensp; &ensp; In his narrative, Marco calls Xingzai \"the city of Heaven\".This may have been influenced by the Chinese proverb \"There is a paradise above, and a Suzhou-Hangzhou below,\" which suggests that there are earthly paradises that are just as beautiful as heaven. At the same time he gives a direct justification for the notation of xingzai: \"it is well worth recording, because this is without doubt the finest and noblest city in the world.\" <br>&ensp; &ensp; Marco Polo offers a comprehensive description of the city of xingzai, including its architecture, the arrangement of its streets, the state of its commerce and handicrafts, the wedding and funeral customs of its inhabitants, the city's fire protection system, and even the income of the Great Khan.";
                        check_1=0
                    }else if(check_1==0){
                        textCont_1.innerHTML = "&ensp; &ensp; Marco's account is basically similar to some Song and Yuan historical accounts. \"For instance, Marco Polo's account of Xingzai's population was consistent with the record of Wu Zimu in the MengLiangLu: after Emperor Gaozong of the Southern Song Dynasty moved to Hangzhou from Jiankang, there were nearly one million of households in the past two centuries. Furthermore, people lived together in the outer city of Hangzhou, the markets, streets, stores, and wares were so numerous that they could be traversed in a matter of days. This passage not only corroborates Marco Polo's estimate of Xingzai's population but also aligns with his depiction of the thriving markets and stores in the city.”(杨志玖,1999)";
                        check_1=1
                    }
                });

                textBox_2.addEventListener('click', function() {
                    if (check_2==1){
                        textCont_2.innerHTML = "<br>&ensp; &ensp; The teeth of the people of Yongchang are covered with gold. \"These people do not have idols or churches but worship the head of the house\" and \"there are no physicians. When someone falls ill he sends for the magicians.\"<br>&ensp;&ensp; Marco Polo provides a detailed account of the unique customs of the region, including Couvade, the process of healing by magicians, and the wars between the armies of the Khan and those of the king of Myanmar and Bengal. The custom of Yongchang described by Marco Polo is consistent with historical data, which supports the authenticity of his account.";
                        check_2=0
                    }else if(check_2==0){
                        textCont_2.innerHTML = "<br>&ensp; &ensp;The description of Couvade can be found in the Ming Dynasty's canonical book, Yunnan Zhi, which states that \"Even the common people regarded their wives as slaves, and the wives were responsible for farming, weaving, trade, and compulsory labour. After giving birth to a child for three days, they handed it over to their husbands to raise and went off to farm and weave on their own.\" (天一阁藏明代方志选刊续编,1990)";
                        check_2=1
                    }
                });

                textBox_3.addEventListener('click', function() {
                    if (check_3==1){
                        textCont_3.innerHTML = "<br>&ensp; &ensp; When Marco Polo wrote about Fuzhou, he described the local people's methods of capturing lions and papiones. In Marco's eyes, \"it is such a fine city and so well ordered in every respect that it is marvelous beyond words.\" In addition to describing the local industries and special products, he also mentioned that \"there is a sect of people whose religion is a mystery to everyone\".<br>&ensp;&ensp;Through persistent visits, Marco and his uncle were eventually able to communicate with the members of this sect. After examining their beliefs, Marco Polo and his uncle concluded that these people were likely Christians.";
                        check_3=0
                    }else if(check_3==0){
                        textCont_3.innerHTML = "<br>&ensp; &ensp; While Paul Pelliot testified that they were not Christians but Manichaeans. The reason was that if they had been Christians, they would have been recognized, and the Manichaeans had some texts which might have been mistaken for the Psalms of the Old Testament. The Manichaeans were prevalent in Zhejiang and Fujian during the Song Dynasty, and there were many Manichaeans in Fuzhou, which was a secret religion forbidden by the government, which is why they did not want to be exposed. (杨志玖,1999)";
                        check_3=1
                    }
                });

                textBox_4.addEventListener('click', function() {
                    if (check_4==1){
                        textCont_4.innerHTML = "<br>&ensp; &ensp; As an experienced traveling merchant, Marco Polo provides detailed descriptions of the protective measures taken by merchants while traversing through the wilderness. For instance, he describes the practice of throwing bamboo sticks into the fire to create a loud explosion that scares away wild beasts. <br>&ensp; &ensp; In addition to these protective measures, Marco Polo also notes various local customs, he mentions that local people refuse to take virgins as wives. Instead, mothers send their daughters to spend the night with passing merchants, and the woman who receives the most souvenirs is considered the most desirable marriage partner. Marco also mentions,\"they have no coinage and do not use the Great Khan's paper money but instead use salt as a currency.\"";
                        check_4=0
                    }else if(check_4==0){
                        textCont_4.innerHTML = "<br>&ensp; &ensp; Salt has been a highly valued commodity in Tibet for centuries, with its significance dating back to the Tang dynasty. In fact, the importance of salt resources was so great that it sparked a war between the forces of Nan-chao, Tang, and Tibet, as Charles Backus writes, \“perhaps the most essential resource that the tibetans hoped to acquire was salt.\” This value of salt continued through the time of Marco Polo, where it was even used as a form of currency,\“ this accords well with the ramusio passage stating that during Marco polo's time the tibetans were willing to exchange precious goods in order to obtain this indispensable mineral. all this shows that Marco polo's account is in perfect accordance with the particularities of the monetary history in Southwest China.\” (Backus,1981;Vogel,2013) ";
                        check_4=1
                    }
                });

                textBox_5.addEventListener('click', function() {
                    if (check_5==1){
                        textCont_5.innerHTML = "<br>&ensp; &ensp; Marco Polo devotes a significant portion of his narrative to describing the huge snakes of the Qarajang, including their capture methods and the medicinal properties of their bile. <br>&ensp;&ensp; He also tells of the evil customs of the region before the Khan's rule: \“If it happened that a handsome gentleman or anyone with a superior air - a 'good shadow' - came to lodge in the house of an inhabitant of this province, they would murder him during the night by poison or other lethal means.”\ This was because they believed that taking over the souls of the deceased would bless them.";
                        check_5=0
                    }else if(check_5==0){
                        textCont_5.innerHTML = "<br>&ensp; &ensp; Although the huge snakes is now extinct in the Dali area, historical records suggest that they were once present in the region. \“The Yuan Dynasty canon Yunnan Tongzhi records an incident from the Tang Dynasty in which a Dali resident named Duan Chicheng beheaded a python that had been devouring people and animals. While the legend may not be entirely accurate, it is possible that the local huge snakes population was considered dangerous.”\  The Southern Song Dynasty scholar Fan Chengda wrote in his work Guihai Yuheng Zhi that \“the gall of a boa, which can grow as large as a pillar, can be used as medicine. Additionally, people in the south have used snake skin to make drums, and snake meat has been consumed as a food source for centuries.\” Even today, snake meat remains a local cuisine in southern China.（方国瑜&林超民,1994;严沛&范成大,1986)";
                        check_5=1
                    }
                });

                textBox_6.addEventListener('click', function() {
                    if (check_6==1){
                        textCont_6.innerHTML = " <br>&ensp;&ensp; Jiandu also implemented the use of salt coins as a circulating currency. Marco Polo provides a detailed account of the process of creating salt coins, as well as the exchange rate between salt coins and gold coins. However, this exchange rate was not fixed and varied depending on the location. In more remote and less developed areas, fewer salt coins could be exchanged for a fixed number of gold coins. <br>&ensp;&ensp; In addition, Marco Polo describes a unique local custom in the area whereby men did not consider it an outrage if a foreigner or another man dishonored him with his wife, daughter, sister, or any woman under his roof. Outsiders would often hang out a sign to indicate a visit when they met with a local woman. Marco attributes this custom to idolatry, with believers thinking that their behavior would be appreciated by the gods.";
                        check_6=0
                    }else if(check_6==0){
                        textCont_6.innerHTML = "<br>&ensp;&ensp; According to Yuanshi there were a total of 95 salt wells in the region,  and \“the salt loaves used in the region of Jaindu, as mentioned by Marco polo, were probably made in a place that is now located in southernmost Sichuan, in the saltworks of Yanyuan.\”  It is worth noting that the unique customs described by Marco Polo bear striking similarities to the marriage customs of the Naxi people. They have been inhabiting the Yanyuan area of Sichuan province since the middle of the 4th century. Notably, their customs are \“Men and women do not get married. Instead, both parties in the relationship usually stay at the woman's house overnight after dinner and return to their mother's house the next morning to labor and live.\”  The relationship is not fixed or exclusive, and this free and open sexual relationship is quite similar to what Marco Polo described.(宋濂,1976; Vogel,2013)";
                        check_6=1
                    }
                });

                textBox_7.addEventListener('click', function() {
                    if (check_7==1){
                        textCont_7.innerHTML = "";
                        check_7=0
                    }else if(check_7==0){
                        textCont_7.innerHTML = "";
                        check_7=1
                    }
                });

                textBox_8.addEventListener('click', function() {
                    if (check_8==1){
                        textCont_8.innerHTML = "";
                        check_8=0
                    }else if(check_8==0){
                        textCont_8.innerHTML = "";
                        check_8=1
                    }
                });

                textBox_9.addEventListener('click', function() {
                    if (check_9==1){
                        textCont_9.innerHTML = "";
                        check_9=0
                    }else if(check_9==0){
                        textCont_9.innerHTML = "";
                        check_9=1
                    }
                });

                textBox_10.addEventListener('click', function() {
                    if (check_10==1){
                        textCont_10.innerHTML = "";
                        check_10=0
                    }else if(check_10==0){
                        textCont_10.innerHTML = "";
                        check_10=1
                    }
                });

                textBox_11.addEventListener('click', function() {
                    if (check_11==1){
                        textCont_11.innerHTML = "";
                        check_11=0
                    }else if(check_11==0){
                        textCont_11.innerHTML = "";
                        check_11=1
                    }
                });
                
                textBox_12.addEventListener('click', function() {
                    if (check_12==1){
                        textCont_12.innerHTML = "";
                        check_12=0
                    }else if(check_12==0){
                        textCont_12.innerHTML = "";
                        check_12=1
                    }
                });

    
            </script>
        </div>
    </section>

    <!--<section class="section-bg4 section-padding " style="height: 800px" id="page_5">
        <div class="container" style="margin-top:100px">
            <h1 class="text-white"><b>How Marco Polo view China?</b></h1>
        </div>
    </section>-->

    <section class="barista-section section-padding section-bg5" style="height: 2200px" id="page_6">
        <div class="container max-width:100%">
            <h1 class="text-white" style="margin-top:30px"><b>References</b></h1>
            <p class="reference_text" style="font-size:120%;color:#b8b8b8"><b>Images:</b></p>
            <p class="reference_text">Markers on map designed by Freepik</p>
            <p class="reference_text">曹婉如. 九域守令圖-中國古代地图集. 第1集., 文物出版社, 1990.</p>
            <p class="reference_text">Mosaic of Marco Polo, Municipal Palace of Genoa: Palazzo Grimaldi Doria-Tursi[https://commons.wikimedia.org/wiki/File:Marco_Polo_Mosaic_from_Palazzo_Tursi.jpg] by Salviati, 1867. Public Domain </p>
            <p class="reference_text">Along the River During the Qingming Festival Season (Qing Court Version)[https://commons.wikimedia.org/wiki/File:Along_the_River_7-119-3.jpg] by Chen Mei (陳枚), Sun Hu (孫祜), Jin Kun (金昆), Dai Hong (戴洪) and Cheng Zhidao (程志道), 1736, Public Domain</p>
            <p class="reference_text">Sculptural bust of traveler Marco Polo[https://unsplash.com/photos/gray-concrete-statue-of-woman-biQBAOtgIOk] by Egor Myznik[https://unsplash.com/@vonshnauzer] under License[https://unsplash.com/license]</p>
            <p class="reference_text">[https://unsplash.com/photos/a-view-of-a-city-with-a-lot-of-tall-buildings-yvyv6cYGgLQ] by Bangyu Wang[https://unsplash.com/@bangyuwang] under License[https://unsplash.com/license]</p>       
            <p class="reference_text">Tea house in Hangzhou[https://unsplash.com/photos/orange-and-black-gazebo-scenery-CyvoE5akJuE] by David Veksler[https://unsplash.com/@davidveksler] under License[https://unsplash.com/license]</p> 
            <p class="reference_text">[https://unsplash.com/photos/white-and-brown-concrete-building-vH_O17suSLU] by 光曦 刘[https://unsplash.com/@liuguangxi] under License[https://unsplash.com/license]</p>
            <p class="reference_text">Gate of prayers[https://unsplash.com/photos/multicolored-streamers-near-snow-mountain-under-blue-and-white-cloudy-sky-NAdinUQTy2c] by Daniele Salutari[https://unsplash.com/@danielesalutari] under License[https://unsplash.com/license]</p>  
            <p class="reference_text">[https://unsplash.com/photos/a-city-on-the-water-vQRE4wGyZyc] by JuniperPhoton[https://unsplash.com/@juniperphoton] under License[https://unsplash.com/license]</p>
            <p class="reference_text">窗外的景色[https://unsplash.com/photos/an-arch-with-a-view-of-a-mountain-and-trees-oxkTY2sZ5FI] by Sam LEGEND[https://unsplash.com/@samirshadab10] under License[https://unsplash.com/license]</p> 
            <p class="reference_text">凤雏大桥[https://unsplash.com/photos/a-bridge-over-a-body-of-water-with-tall-buildings-in-the-background-yGB4X6tWX8k] by Sean Hu[https://unsplash.com/@seanhuchina] under License[https://unsplash.com/license]</p> 
            <p class="reference_text">[https://unsplash.com/photos/brown-and-red-temple-during-daytime-6qXPU-et7MA] by wong zihoo[https://unsplash.com/@zihoowong] under License[https://unsplash.com/license]</p>    
            <p class="reference_text">[https://unsplash.com/photos/white-and-black-panda-HFgxFulbsF4] by billow926[https://unsplash.com/@billow926] under License[https://unsplash.com/license]</p>  
            <p class="reference_text">[https://unsplash.com/photos/people-riding-on-boat-during-daytime-CLwzS2h4uNQ] by Yusong He[https://unsplash.com/@quanquan1115] under License[https://unsplash.com/license]</p>     
            <p class="reference_text">Baoshan Evening[https://commons.wikimedia.org/wiki/File:Baoshan_Evening_(29947417367).jpg] by Rod Waddington, 2018. Public Domain </p>
            <p class="reference_text">Fuzhou Cityscape (Taixi CBD)[https://commons.wikimedia.org/wiki/File:Fuzhou_Cityscape_(Taixi_CBD).jpg] by Listwiseafford, 2017. Public Domain </p>
            <p class="reference_text" style="font-size:120%;color:#b8b8b8"><b>Text:</b></p>
            <p class="reference_text">Haw, Stephen G. Marco Polo’s China a Venetian in the Realm of Khubilai Khan. London ; Routledge, 2006.</p>
            <p class="reference_text">Polo, Marco. The Travels. Translated by Nigel Cliff. London: Penguin Classics, 2015.</p>
            <p class="reference_text">Vogel, Hans Ulrich. Marco Polo Was in China : New Evidence from Currencies, Salts and Revenues. Leiden: Brill, 2013.</p>
            <p class="reference_text">杨志玖. 马可波罗在中国 = Marco Polo in China. 第1版 (天津市: 南开大学出版社, 1999),25.</p>
            <p class="reference_text">方国瑜, and 林超民. 《马可波罗行纪》云南史地丛考. 第1版. 北京: 民族出版社, 1994.</p>
            <p class="reference_text">姬庆红. 马可·波罗来华问题研究 = Marco Polo. 第1版. 北京: 中国社会科学出版社, 2019.</p>
            <p class="reference_text">刘振宁. “《马可波罗行纪》西南民俗述造解义.” 贵州师范大学学报（社会科学版）, no. 4 (2022): 118–29. </p>
            <p class="reference_text">天一阁藏明代方志选刊续编. 第71册. 上海：上海书店出版社,1990.</p>
            <p class="reference_text">严沛, and 范成大. 桂海虞衡志校注. 第1版. 南宁市: 广西人民出版社, 1986.</p>
            <p class="reference_text" style="color:#b8b8b8"><b style="color:#fff"><br>Remarks:</b><br>To ensure that our audience can fully immerse themselves in the historical context, we have placed significant emphasis on the historical maps. We understand that the precise locations may not always be available on the historical maps, so we have adopted a two-fold approach:<br>
            <b style="color:#fff">Pinpointing Locations on Historical Maps:</b> Whenever possible, we have identified and marked the exact locations on the historical maps using <b style="color:#1f93ff">blue markers</b>. This allows our audience to visualize the geographical aspects of each historical site accurately.
            <br><b style="color:#fff">Referring to Real Maps for Missing Locations:</b> In cases where specific locations are not depicted on the historical maps, we marked the points using <b style="color:#8c8c8c">grey markers</b> with reference to the modern geography.</p>
            <p class="reference_text"  style="color:#b8b8b8"><b style="color:#fff">List of Locations involved in this Project:</b>
                <br><b style="color:#fff">Cliff:</b> Xingzai, Yongchang, Fuzhou-City, Tibet, Qarajang-City, Jiandu, Xiezhou, Xiangyangfu, Daidu, Chengdufu, Zhenzhou, Zayton, Fuling, Yachi, Dongpingfu, Fuzhou-Kingdom, Changzhou, Chang'anfu, Suzhou, Guazhou, Xinzhou Matou, Tingzhou, Jianningfu, Changlu, Yangzhou, Zhenjiangfu, Hejianfu, Huai'anzhou, Guangyuan, Houguan, Aq-Baliq, Aq-Baliq Manzi, Liucheng, Taiyuanfu, Baoying, Anqing, Taizhou, Jiangling, Ganpu, Gaoyou, Suichang, Hezhongfu, Pizhou, Quzhou, Suqian, Tonglu, Tongzhou, Changxing, Zhuozhou, Wuxing, Chuzhou, Wuzhou, Wujiang, Pingyangfu, Zardandan, Kuizhou, Huaiyin, Qarajang-Kingdom.
                <br><b style="color:#fff">Haw:</b> Quinsai, Uncian, Fugiu, Tebet, Caragian-City, Gaindu, Caiciu, Saianfu, Taidu, Sindufu, Singiu, Çaiton, Cuigiu-City, Iaci, Tundinfu, Choncha, Ciangiu, Quengianfu, Sugiu, Caigiu, Singiu Matu, Tingiu, Quenlinfu, Cianglu, Yangiu, Cinghianfu, Cacanfu, Coigangiu, cuncun, Vuguen, Achbaluch, Acbalec Mangi, Lingiu, Taianfu, Paughin, Namghin, Tigiu, Ciangli, Gampu, Cauyu, Cianscian, Cacionfu, Pingiu, Ghiugiu, Ciugiu, Tanpigiu, Cingiu, Ciangan, Giogiu, Vughin, Cugiu, Viugiu[1], Vugiu[1], Pianfu, Çardandan, Cuigiu, Caguy, Caragian-Kingdom
                <br><b style="color:#fff">中文:</b> 杭州, 保山, 福州, 西藏, 大理, 西昌, 解州, 襄阳, 北京, 成都, 仪征, 泉州, 涪陵, 昆明, 东平, 江浙行省, 常州, 西安, 苏州, 邗江, 济宁, 长汀, 建瓯, 沧州, 扬州, 镇江, 河间, 淮安, 广元, 闽侯, 正定, 汉中, Lingiu[2], 太原, 宝应, 安庆, 泰州, 德州, 澉浦, 高邮, 遂昌, 蒲州, 古邳, 衢州, 宿迁, 桐庐, 南通, 长兴, 涿州, 湖州, 丽水, 金华, 吴江, 临汾, 保山, 奉节, 淮阴, Caragian-Kingdom[2].</p>
            <p class="reference_text">[1]As the two locations was identified with the same name in Haw's definition, we deifnded it with other names on edition F so as to clssify them.</p>
            <p class="reference_text">[2]As the city does not appear on modern China Map's definition, it is named by Haw's edition.</p>
        </div>
    </section>


</main>

</body>
</html>
